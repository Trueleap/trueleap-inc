---
import Base from './Base.astro';
import { Header } from '../components/layout/Header';
import { Footer } from '../components/layout/Footer';
import { payload } from '../lib/payload';
import type { Language } from '../lib/i18n';

interface Props {
  title: string;
  description?: string;
  lang?: Language;
}

const { title, description, lang = 'en' } = Astro.props;
const cms = payload;

const navigation = await cms.globals.read<Record<string, unknown>>('navigation');
const siteSettings = await cms.globals.read<Record<string, unknown>>('site-settings');
---

<Base title={title} description={description || siteSettings?.siteDescription} lang={lang}>
  <Header
    client:load
    lang={lang}
    navigationData={navigation?.headerGroups}
    headerCta={navigation?.headerCta}
  />
  <slot />
  <Footer
    client:visible
    lang={lang}
    footerGroups={navigation?.footerGroups}
    footerQuote={siteSettings?.footerQuote}
    copyright={siteSettings?.copyright}
  />
</Base>
