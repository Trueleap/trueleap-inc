name = "trueleap-inc"
account_id = "b01357b51e0ceb9e37e2bdf82bbcbc34"
main = "./dist/_worker.js/index.js"
compatibility_date = "2026-02-04"
compatibility_flags = ["nodejs_compat"]

[assets]
binding = "ASSETS"
directory = "./dist"

[[r2_buckets]]
binding = "IMAGES_BUCKET"
bucket_name = "trueleap-images"

[ai]
binding = "AI"

# AI Gateway for Anthropic (optional â€” falls back to Workers AI if not set)
# Set secrets: wrangler secret put ANTHROPIC_API_KEY --env dev
[vars]
CF_ACCOUNT_ID = "b01357b51e0ceb9e37e2bdf82bbcbc34"
AI_GATEWAY_ID = "trueleap"
PAYLOAD_URL = "https://cms.trueleapinc.com"

[observability]
enabled = true

# Dev: dev.trueleapinc.com
[env.dev]
routes = [
  { pattern = "dev.trueleapinc.com/*", zone_name = "trueleapinc.com" },
]
[env.dev.vars]
CF_ACCOUNT_ID = "b01357b51e0ceb9e37e2bdf82bbcbc34"
AI_GATEWAY_ID = "trueleap"
PAYLOAD_URL = "https://cms.trueleapinc.com"
[[env.dev.r2_buckets]]
binding = "IMAGES_BUCKET"
bucket_name = "trueleap-images"
[env.dev.ai]
binding = "AI"

# Preview: dev-preview.trueleapinc.com (always fetches draft content)
[env.preview]
routes = [
  { pattern = "dev-preview.trueleapinc.com/*", zone_name = "trueleapinc.com" },
]
[env.preview.vars]
CF_ACCOUNT_ID = "b01357b51e0ceb9e37e2bdf82bbcbc34"
AI_GATEWAY_ID = "trueleap"
PAYLOAD_URL = "https://cms.trueleapinc.com"
DRAFT_MODE = "true"
[[env.preview.r2_buckets]]
binding = "IMAGES_BUCKET"
bucket_name = "trueleap-images"
[env.preview.ai]
binding = "AI"
